{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "CMake: 配置",
            "type": "shell",
            "command": "cmake",
            "args": [
                "-DCMAKE_TOOLCHAIN_FILE=${workspaceFolder}/cmake/sdcc-generic.cmake",
                "-DCMAKE_MODULE_PATH=${workspaceFolder}/cmake",
                "-DSTM8_CHIP=stm8l052c6",
                "-DSTM8_StdPeriph_DIR=${workspaceFolder}/StdPeriph",
                "-G", "Ninja",
                "-S", "${workspaceFolder}",
                "-B", "${workspaceFolder}/build"
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "problemMatcher": []
        },
        {
            "label": "CMake: 构建",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "${workspaceFolder}/build"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "dependsOn": "CMake: 配置"
        },
        {
            "label": "CMake: 清理",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "${workspaceFolder}/build/stm8l-app",
                "--target",
                "clean"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "problemMatcher": []
        },
        {
            "label": "CMake: 彻底清理",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-Command",
                "Remove-Item -Path '${workspaceFolder}/build/stm8l-app/source/app/*.ihx','${workspaceFolder}/build/stm8l-app/source/app/*.map','${workspaceFolder}/build/stm8l-app/source/app/*.lk','${workspaceFolder}/build/stm8l-app/source/app/CMakeFiles/stm8l-app.dir/**/*.rel','${workspaceFolder}/build/stm8l-app/source/app/CMakeFiles/stm8l-app.dir/**/*.asm','${workspaceFolder}/build/stm8l-app/source/app/CMakeFiles/stm8l-app.dir/**/*.lst','${workspaceFolder}/build/stm8l-app/source/app/CMakeFiles/stm8l-app.dir/**/*.sym','${workspaceFolder}/build/stm8l-app/source/app/CMakeFiles/stm8l-app.dir/**/*.rst' -ErrorAction SilentlyContinue; Write-Host '清理完成'"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "problemMatcher": []
        },
        {
            "label": "CMake: 重新配置并构建",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "${workspaceFolder}/build",
                "--",
                "clean"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "dependsOn": [
                "CMake: 配置",
                "CMake: 构建"
            ],
            "problemMatcher": []
        }
    ]
}


